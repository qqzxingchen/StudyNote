
# 单机安装 hadoop hive hbase
* 服务器环境： CentOS7 64 位



### 安装 hadoop 2.6.5



### 安装 mysql 作为 hive 的 metastore

```bash
# 安装 mysql 源
# 在 CentOS 7 的官方源中，已经没有了 mysql，只有 mariadb。如果想要使用 mysql 则需要安装一个源，才能再安装 mysql
$ wget http://dev.mysql.com/get/mysql-community-release-el7-5.noarch.rpm
$ rpm -ivh mysql-community-release-el7-5.noarch.rpm

# 安装 mysql
$ yum install mysql-community-server

# 启动mysql服务，并设置mysql开机启动
$ systemctl start mysqld
$ systemctl enable mysqld

# 初始化时mysql登陆无须帐号密码，这里可以验证是否成功安装
# 同时创建数据库 xc_hive_metastore 作为 hive 的 metastore 
# 并创建用户 hive 作为 hive 链接 xc_hive_metastore 库的用户名
$ mysql
mysql> CREATE DATABASE xc_hive_metastore;
mysql> CREATE USER 'hive'@'%' IDENTIFIED BY 'hive';
mysql> GRANT ALL PRIVILEGES ON xc_hive_metastore.* TO 'hive'@'%' WITH GRANT OPTION;
mysql> flush privileges;
```

### 安装 Hive 2.1.1
* 下载 hive 2.1.1 。
    * 需要注意的是，hive 版本与 hadoop 版本需要配套
    * 文件夹名称： hive-2.1.1-bin.tar.gz

* 选用 mysql 作为 hive 的 metastore 

```bash
# 将 hive-2.1.1-bin.tar.gz 解压到 SoftWareBin/hive/ 目录下，并将其改名为 hive-2.1.1
$ cd ~
$ mkdir -p SoftWareBin/hive
$ mv hive-2.1.1-bin.tar.gz SoftWareBin/hive
$ cd SoftWareBin/hive/
$ tar zxvf hive-2.1.1-bin.tar.gz
$ mv apache-hive-2.1.1-bin hive-2.1.1
$ cd hive-2.1.1

# 在 hdfs 上创建 hive 的文件存储路径
$ hadoop dfs -mkdir /tmp
$ hadoop dfs -mkdir /user/hive/warehouse
$ hadoop dfs -chmod g+w /tmp
$ hadoop dfs -chmod g+w /user/hive/warehouse

# 下载 mysql 的 jdbc 驱动，将其移动到 $HIVE_HOME/lib
$ mv mysql-connector-java-5.1.33.jar ~/SoftWareBin/hive/hive-2.1.1/lib

# 添加环境变量
$ vim ~/.bashrc
$ >>> export HIVE_HOME=/home/hadoop/SoftWareBin/hive/hive-2.1.1
$ >>> export PATH=$PATH:$HIVE_HOME/bin

# 修改 hive 配置文件
$ cd $HIVE_HOME/conf
$ cp hive-default.xml.template hive-site.xml
$ vim hive-site.xml
vim>
vim> # 修改hive的配置 hive.metastore.schema.verification 默认为true，修改为false
vim> <property>
vim>   <name>hive.metastore.schema.verification</name>
vim>   <value>false</value>
vim> </property>
vim>
vim> # 修改hive的配置 javax.jdo.option.ConnectionURL 
vim> <property>
vim>    <name>javax.jdo.option.ConnectionURL</name>
vim>    <value>jdbc:mysql://localhost:3306/xc_hive_metastore?createDatabaseIfNoExist=true</value>
vim> </property>
vim> # 修改hive的配置 javax.jdo.option.ConnectionURL 
vim> <property>
vim>    <name>javax.jdo.option.ConnectionDriverName</name>
vim>    <value>com.mysql.jdbc.Driver</value>
vim> </property>
vim> # 修改hive的配置 javax.jdo.option.ConnectionURL 
vim> <property>
vim>    <name>javax.jdo.option.ConnectorUserName</name>
vim>    <value>hive</value>
vim> </property>
vim> # 修改hive的配置 javax.jdo.option.ConnectionURL 
vim> <property>
vim>    <name>javax.jdo.option.ConnectionPassword</name>
vim>    <value>hive</value>
vim> </property>
vim>
vim> # 修改hive的配置 hive.querylog.location 到一个实际的目录(xc_hive_iotmp)
vim> <property>
vim>   <name>hive.querylog.location</name>
vim>   <value>/home/hadoop/SoftWareBin/hive/xc_hive_iotmp</value>
vim>   <description>Location of Hive run time structured log file</description>
vim> </property>
vim> # 修改hive的配置 hive.exec.local.scratchdir 到一个实际的目录(xc_hive_iotmp)
vim> <property>
vim>   <name>hive.exec.local.scratchdir</name>
vim>   <value>/home/hadoop/SoftWareBin/hive/xc_hive_iotmp</value>
vim>   <description>Local scratch space for Hive jobs</description>
vim> </property>
vim> # 修改hive的配置 hive.downloaded.resources.dir 到一个实际的目录(xc_hive_iotmp)
vim> <property>
vim>   <name>hive.downloaded.resources.dir</name>
vim>   <value>/home/hadoop/SoftWareBin/hive/xc_hive_iotmp</value>
vim>   <description>Temporary local directory for added resources in the remote file system.</description>
vim> </property>
vim>

# 初始化 metastore
$ cd $HIVE_HOME
$ ./bin/schematool  -initSchema -dbType mysql

```










